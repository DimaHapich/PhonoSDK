<project name="Check source code" default="check" basedir=".">

	<import file="release.xml" />

	<property name="checkstyle.home" value="${env.CHECK_STYLE_HOME}" />

	<property name="style.config" value="${tools.dir}/style/codingstyle.xml" />
	<property name="style.report.dir" value="${build.reports}/style_report" />
	<property name="style.report" value="${style.report.dir}/checkstyle_report.html" />
	<property name="style.report.style" value="${tools.dir}/style/checkstyle-noframes.xsl" />

	<path id="checkstyle.lib">
		<fileset dir="${checkstyle.home}">
			<include name="checkstyle-all-*.jar" />
		</fileset>
	</path>

	<taskdef resource="checkstyletask.properties" classpathref="checkstyle.lib" />

	<target name="check-style" depends="-prepare" description="validate the coding style">
		<mkdir dir="${style.report.dir}" />
		<checkstyle config="${style.config}" failureProperty="checkstyle.failure" failOnViolation="false">
			<formatter type="xml" tofile="${style.report.dir}/checkstyle_report.xml" />
			<fileset dir="${src.dir}">
				<include name="com/**/*.java" />
			</fileset>
		</checkstyle>
		<style in="${style.report.dir}/checkstyle_report.xml" out="${style.report}" style="${style.report.style}" />
	</target>

	<target name="check">
		<antcall target="check-style" />
	</target>

</project>